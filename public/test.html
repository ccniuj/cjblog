
<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Multi-page template</title>
	<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
  <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
  <script>
    $(document).bind('mobileinit',function(){
        $.mobile.changePage.defaults.changeHash = false;
        $.mobile.hashListeningEnabled = false;
        $.mobile.pushStateEnabled = false;
    });
  </script>
  <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
  <script type="text/javascript">
  $(document).on("pagecreate", "#list", function(event) {
  	$(document).on('click', '.test', function(event) {
      event.preventDefault();
      // $.mobile.pageContainer.pagecontainer("change", "#p2", {
      //   foo: 'bar'
      // });
      $.mobile.pageContainer.pagecontainer("change", "#info", { 
        transition: 'slide',
        foo: 'bar',
        id: this.dataset.id
      });
    });

    $.ajax({
      dataType: "json",
      url: 'https://apiservertest.herokuapp.com/',
      success: function(data) {
          data.forEach(function(d) {
            var li = "<li><a class='test' href='#info' data-transition='slide' data-id='" + d.id + "'>" + d.title + "</a></li>";
            $('ul').append(li);
          })
      }
    });
  });
  $(document).on("pagebeforechange", function(event, data){
    var id = data.options.id;
      if (typeof(id) != 'undefined') {
      $.ajax({
        dataType: "json",
        url: 'https://apiservertest.herokuapp.com/articles/' + id,
        success: function(data) {
          var html = data.content;
          $('#info_content').html('');
          $('#info_content').append(html);
        }
      });  
    }
  });

  </script>
</head>

<body>

<div data-role="page" id="list">

	<div data-role="header">
		<h1>list</h1>
	</div><!-- /header -->

	<div role="main" class="ui-content" >
		<h2>articles</h2>

		<ul data-role="listview"></ul>

	</div><!-- /content -->

	<div data-role="footer" data-theme="a">
		<h4>Page Footer</h4>
	</div><!-- /footer -->
</div><!-- /page one -->

<div data-role="page" id="info">
	<div data-role="header">
		<h1>Info</h1>
		<a data-rel="back" data-transition='slide' data-direction='reverse'>back</a>

	</div><!-- /header -->
  <div role="main" class="ui-content" id="info_content">
  </div>
</div>
</body>
</html>
